package com.falcon.avisep.controllers;


import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.RequestParam;

import com.falcon.avisep.model.UserAvis;
import com.falcon.avisep.repository.UserAvisRepository;

/**
 * REST controller for managing UserAvis.
 */
@Controller
@RequestMapping("/avisepUser")
public class UserAvisResource {

    private final Logger log = LoggerFactory.getLogger(UserAvisResource.class);
    private static final String ENTITY_NAME = "userAvis";
        
    private final UserAvisRepository userAvisRepository;

    public UserAvisResource(UserAvisRepository userAvisRepository) {
        this.userAvisRepository = userAvisRepository;
    }

    @RequestMapping("displayUser")
	public String consultUsers(Model model){
		
		Iterable<UserAvis> userAvis = userAvisRepository.findAll();
		
		model.addAttribute("userAvis", userAvis);
		
		return "displayUser";
	}
	
	@RequestMapping(value = "salvarUser", method = RequestMethod.POST )
	public String saveUser(@RequestParam("firstN") String firstN, @RequestParam("lastN")String lastN, 
			@RequestParam("login") String login,@RequestParam("email") String email,@RequestParam("password") String password, Model model){
		
		UserAvis userAvis = new UserAvis();
		
		userAvis.setFirstName(firstN);		
		userAvis.setLastName(lastN);
		userAvis.setLogin(login);
		userAvis.setEmail(email);
		userAvis.setPasswd(password);
		userAvisRepository.save(userAvis);
		//new EmailService().enviar(nome, email);
		
		Iterable<UserAvis> userAvis1 = userAvisRepository.findAll();
		
		
		model.addAttribute("userAvis", userAvis1);
		
		return "displayUser";
		
	}
}
